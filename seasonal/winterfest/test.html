<link
	href="https://fonts.googleapis.com/css?family=Alegreya+Sans|Amatic+SC"
	rel="stylesheet"
	type="text/css"
/>

<div id="winterfest"></div>

<style type="text/css">
	html {
		background: #c6c6c6;
	}

	#winterfest {
		font-size: 9px;
		height: 97em;
		margin: 0 auto;
		position: relative;
		width: 77em;
	}

	#winterfest a {
		border: 3px solid white;
		border-radius: 2px;
		box-sizing: border-box;
		display: inline-block;
		font-family: 'Amatic SC', Helvetica, sans-serif;
		left: 50%;
		overflow: hidden;
		position: absolute;
		top: 50%;
		transform: translate(-50%, -50%);
	}

	#winterfest a:after {
		align-items: center;
		background: inherit;
		bottom: 0;
		color: white;
		content: attr(data-number);
		display: flex;
		font-size: inherit;
		justify-content: center;
		left: 0;
		position: absolute;
		right: 0;
		top: 0;
		transition: 0.9s ease all;
	}

	#winterfest .slot-24,
	#winterfest .slot-23 {
		height: 25em;
		width: 25em;
	}

	#winterfest .slot-24:after,
	#winterfest .slot-23:after {
		font-size: 12em;
	}

	#winterfest .slot-22,
	#winterfest .slot-21,
	#winterfest .slot-14,
	#winterfest .slot-13,
	#winterfest .slot-12,
	#winterfest .slot-11 {
		height: 19em;
		width: 19em;
	}

	#winterfest .slot-22:after,
	#winterfest .slot-21:after,
	#winterfest .slot-14:after,
	#winterfest .slot-13:after,
	#winterfest .slot-12:after,
	#winterfest .slot-11:after {
		font-size: 11em;
	}

	#winterfest .slot-20,
	#winterfest .slot-19 {
		height: 15em;
		width: 15em;
	}

	#winterfest .slot-20:after,
	#winterfest .slot-19:after {
		font-size: 9em;
	}

	#winterfest .slot-18,
	#winterfest .slot-17 {
		height: 13em;
		width: 13em;
	}

	#winterfest .slot-18:after,
	#winterfest .slot-17:after {
		font-size: 8em;
	}

	#winterfest .slot-16,
	#winterfest .slot-15 {
		height: 11em;
		width: 11em;
	}

	#winterfest .slot-16:after,
	#winterfest .slot-15:after {
		font-size: 7em;
	}

	#winterfest .slot-10,
	#winterfest .slot-9,
	#winterfest .slot-8,
	#winterfest .slot-7,
	#winterfest .slot-6,
	#winterfest .slot-5 {
		height: 9em;
		width: 9em;
	}

	#winterfest .slot-10:after,
	#winterfest .slot-9:after,
	#winterfest .slot-8:after,
	#winterfest .slot-7:after,
	#winterfest .slot-6:after,
	#winterfest .slot-5:after {
		font-size: 6em;
	}

	#winterfest .slot-4,
	#winterfest .slot-3,
	#winterfest .slot-2,
	#winterfest .slot-1 {
		height: 5em;
		width: 5em;
	}

	#winterfest .slot-4:after,
	#winterfest .slot-3:after,
	#winterfest .slot-2:after,
	#winterfest .slot-1:after {
		font-size: 3em;
	}

	#winterfest .slot-24 {
		margin-left: -13em;
		margin-top: 5em;
	}
	#winterfest .slot-23 {
		margin-left: 13em;
		margin-top: -5em;
	}
	#winterfest .slot-22 {
		margin-left: -10em;
		margin-top: -18em;
	}
	#winterfest .slot-21 {
		margin-left: 10em;
		margin-top: 18em;
	}
	#winterfest .slot-20 {
		margin-left: -18em;
		margin-top: -36em;
	}
	#winterfest .slot-19 {
		margin-left: 18em;
		margin-top: 36em;
	}
	#winterfest .slot-18 {
		margin-left: -27em;
		margin-top: -21em;
	}
	#winterfest .slot-17 {
		margin-left: 27em;
		margin-top: 21em;
	}
	#winterfest .slot-16 {
		margin-left: -32em;
		margin-top: 2em;
	}
	#winterfest .slot-15 {
		margin-left: 32em;
		margin-top: -2em;
	}
	#winterfest .slot-14 {
		margin-left: -20em;
		margin-top: 28em;
	}
	#winterfest .slot-13 {
		margin-left: 20em;
		margin-top: -28em;
	}
	#winterfest .slot-12 {
		margin-left: 0;
		margin-top: 38em;
	}
	#winterfest .slot-11 {
		margin-left: 0;
		margin-top: -38em;
	}
	#winterfest .slot-10 {
		margin-left: 31em;
		margin-top: 9em;
	}
	#winterfest .slot-9 {
		margin-left: -31em;
		margin-top: -9em;
	}
	#winterfest .slot-8 {
		margin-left: -31em;
		margin-top: 13em;
	}
	#winterfest .slot-7 {
		margin-left: 31em;
		margin-top: -13em;
	}
	#winterfest .slot-6 {
		margin-left: 5em;
		margin-top: -23em;
	}
	#winterfest .slot-5 {
		margin-left: -5em;
		margin-top: 23em;
	}
	#winterfest .slot-4 {
		margin-left: -13em;
		margin-top: 41em;
	}
	#winterfest .slot-3 {
		margin-left: 13em;
		margin-top: -41em;
	}
	#winterfest .slot-2 {
		margin-left: -23em;
		margin-top: -11em;
	}
	#winterfest .slot-1 {
		margin-left: 23em;
		margin-top: 11em;
	}

	#winterfest a.open:after {
		transform: translate(-100%, -100%) rotate(-30deg);
	}

	#winterfest img {
		box-sizing: border-box;
		height: 100%;
		object-fit: cover;
		opacity: 0;
		width: 100%;
	}

	#winterfest .open img {
		opacity: 1;
	}

	#winterfest [src*='sparkles'],
	#winterfest [src*='heart'],
	#winterfest [src*='yellow-candy'],
	#winterfest [src*='pink-candy'],
	#winterfest [src*='shooting-star'],
	#winterfest [src*='star'] {
		padding: 1em;
	}

	#winterfest [src*='pip'],
	#winterfest [src*='stormy'],
	#winterfest [src*='love'] {
		padding: .5em;
	}
</style>

<script type="text/javascript">
	const links = [
		{
			background: '#a9dbd7',
			link: undefined,
			number: '1',
			slot: '5',
			src: './shooting-star.gif',
		},
		{
			background: '#8ddec5',
			link: undefined,
			number: '2',
			slot: '2',
			src: './star.gif',
		},
		{
			background: '#f7a170',
			link: undefined,
			number: '3',
			slot: '13',
			src: './fire.gif',
		},
		{
			background: '#ff93a3',
			link: undefined,
			number: '4',
			slot: '10',
			src: './yellow-candy.gif',
		},
		{
			background: '#ff93a3',
			link: undefined,
			number: '5',
			slot: '16',
			src: './stormy.gif',
		},
		{
			background: '#d7c8df',
			link: undefined,
			number: '6',
			slot: '6',
			src: './pip.gif',
		},
		{
			background: '#a9dbd7',
			link: undefined,
			number: '7',
			slot: '15',
			src: './love.gif',
		},
		{
			background: '#82a4d8',
			link: undefined,
			number: '8',
			slot: '4',
			src: './heart.gif',
		},
		{
			background: '#82a4d8',
			link: undefined,
			number: '9',
			slot: '9',
			src: './pink-candy.gif',
		},
		{
			background: '#d7c0f5',
			link: undefined,
			number: '10',
			slot: '21',
			src: './cookies.gif',
		},
		{
			background: '#ac84c0',
			link: undefined,
			number: '11',
			slot: '18',
			src: './cuddle.gif',
		},
		{
			background: '#89ca8f',
			link: undefined,
			number: '12',
			slot: '7',
			src: './star.gif',
		},
		{
			background: '#ffc9d1',
			link: undefined,
			number: '13',
			slot: '14',
			src: './factory.gif',
		},
		{
			background: '#a9dbd7',
			link: undefined,
			number: '14',
			slot: '11',
			src: './snowglobe.gif',
		},
		{
			background: '#ac84c0',
			link: undefined,
			number: '15',
			slot: '1',
			src: './sparkles.gif',
		},
		{
			background: '#89ca8f',
			link: undefined,
			number: '16',
			slot: '22',
			src: './aftermath.gif',
		},
		{
			background: '#ff93a3',
			link: undefined,
			number: '17',
			slot: '12',
			src: './playing.gif',
		},
		{
			background: '#509e7c',
			link: undefined,
			number: '18',
			slot: '20',
			src: './toys.gif',
		},
		{
			background: '#9cf3e0',
			link: undefined,
			number: '19',
			slot: '19',
			src: './unicorn.gif',
		},
		{
			background: '#ea96bf',
			link: undefined,
			number: '20',
			slot: '8',
			src: './heart.gif',
		},
		{
			background: '#82a4d8',
			link: undefined,
			number: '21',
			slot: '23',
			src: './singing.gif',
		},
		{
			background: '#ed9ec4',
			link: undefined,
			number: '22',
			slot: '17',
			src: './tree.gif',
		},
		{
			background: '#82a4d8',
			link: undefined,
			number: '23',
			slot: '3',
			src: './sparkles.gif',
		},
		{
			background: '#f5c876',
			link: undefined,
			number: '24',
			slot: '24',
			src: './wreath.gif',
		},
	]

	function getClosestAnchor(root, element) {
		if (element === root) return

		return element.tagName === 'A'
			? element
			: getClosestAnchor(root, element.parentElement)
	}

	function hasLink(anchor) {
		if (!anchor) return false
		const href = anchor.getAttribute('href')
		return Boolean(href) && href !== '#'
	}

	document.addEventListener('DOMContentLoaded', () => {
		const winterfest = document.getElementById('winterfest')
		let open = JSON.parse(localStorage.getItem('winterfest')) || []

		links.forEach(({ background, link, number, src, slot }) => {
			const image = document.createElement('img')
			const anchor = document.createElement('a')

			image.setAttribute('src', src)
			anchor.setAttribute('id', 'day-' + number)
			anchor.dataset.number = number
			anchor.setAttribute('style', 'background: ' + background)
			anchor.classList.add('slot-' + slot)

			if (link) {
				anchor.setAttribute('href', link)
				anchor.setAttribute('target', '_blank')
			}

			anchor.appendChild(image)
			winterfest.appendChild(anchor)
		})

		winterfest.addEventListener('click', event => {
			const anchor = getClosestAnchor(winterfest, event.target)

			if (!hasLink(anchor)) {
				event.preventDefault()
				return
			}

			if (!anchor.classList.contains('open')) {
				event.preventDefault()
				anchor.classList.add('open')
				open.push(anchor.getAttribute('id').replace('day-', ''))
				localStorage.setItem('winterfest', JSON.stringify(open))
			}
		})

		open.forEach(number => {
			const anchor = document.getElementById('day-' + number)
			if (hasLink(anchor)) {
				anchor.classList.add('open')
			}
		})
	})
</script>
